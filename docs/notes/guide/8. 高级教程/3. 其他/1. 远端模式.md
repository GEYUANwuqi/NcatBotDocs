---
title: 远端模式
createTime: 2025/02/09 16:45:00
permalink: /guide/inxart0k/
---

# [血的教训](https://wesley-young.github.io/2025-09-05-attack-on-onebot-service)

:::warning
WebUI token 和 WebSocket token **必须使用强 token（包含大小写字母、数字、符号，至少 12 位）**，否则可能会被暴力破解，导致 NapCat 服务器被入侵。
:::

## 什么是远端模式

远端模式下，NcatBot 不会在本地启动 NapCat，而是连接到远端的 NapCat 服务器。

## 什么时候适合使用远端 NapCat 接口

- ==具备基本的网络和操作系统知识的前提下==。
- 使用 Docker 部署 NapCat 和 NcatBot, 但不希望 NapCat 和 NcatBot 在同一个容器中运行。
- NapCat 和 NcatBot 需要分开部署在不同的服务器上。
- 本地无法正常登录 NapCat。

## 准备工作

:::warning
务必使用强 token（包含大小写字母、数字、符号，至少 12 位），否则可能会被暴力破解，导致 NapCat 服务器被入侵。
:::

- 参考 [NapCat 安装教程](https://napneko.github.io/guide/boot/Shell) 安装 NapCat。
- 启动 NapCat 服务，扫码登录，拿到 NapCat WebUI token 和 WebUI 地址（通常是 `http://<服务器 IP>:6099/webui/`）。
- 使用 NapCat WebUI token 登录 NapCat WebUI，
- WebUI 界面中，点击左边栏的 "网络配置"。
- 点击 "新建"，选择 `Websocket服务器`。
- 填写以下信息：
  - 名称：随便起一个名字，比如 `NcatBot`。
  - Host：如果是公网服务器，填写 `0.0.0.0`。
  - Port：默认 `3001`，也可以改成其它端口，但要记住。
  - Token：==必须使用强 token==（包含大小写字母、数字、符号，至少 12 位）。
  - 勾选 "启用"。
- 检查服务器防火墙、系统防火墙正确放通。

## 填写有关配置项

根据 [NapCat 文档](https://napneko.github.io/), 在远端正确配置 NapCat 及其 WebSocket 服务器。

参考[配置项](../../2.%20基本开发/4.%20配置项.md)填写 `ws_uri` 和 `ws_token`。并将 `remote_mode` 设置为 `True`。

如果需要，也可以填写 `webui_url` 和 `webui_token`。

## 已知局限

- 使用远端 NapCat 模式时，无法发送大于 30MB（约数）的文件。
- 获取文件时，由于 NapCat 和 NcatBot 不在同一机器，文件路径可能失效，但 uri 仍然有效。
