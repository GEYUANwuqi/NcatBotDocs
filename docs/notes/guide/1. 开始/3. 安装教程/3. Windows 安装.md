---
title: Windows 安装
createTime: 2025/02/07 15:21:39
permalink: /guide/wininsta/
---

::: warning
此教程只适用 Window10、Windows11 操作系统。
:::

## 任务列表

我们给出一个简单的任务清单, 你可以按照下面的步骤来安装 NcatBot.

1. 正确安装 Python3.12

2. 通过 pip 安装 NcatBot

3. 安装最新版 QQ

4. 运行代码并扫码登录

## 1. 安装 Python

[教程](https://zhuanlan.zhihu.com/p/111168324)

## 2. 安装 NcatBot

::: warning
不要从 GitHub 上下载 .zip 压缩包；如果下载并解压过，请删掉解压出来的文件。
:::

项目已经发布到 PYPI, 可以使用 pip 直接下载本项目.

按下 `Win+R`, 在左下角打开**运行**, 输入 `powershell` 并回车, 打开**终端**.

复制下面的代码, 粘贴到**终端**中, 按回车执行.

::: code-tabs
@tab pip(稳定版, 推荐)

```shell
pip install ncatbot -U -i https://mirrors.aliyun.com/pypi/simple
```
:::

## 3. 安装最新版 QQ

:::tip
如果出现无法登录的问题，请先安装最新版 QQ
:::

卸载掉电脑上已经安装的 QQ。

前往 [QQ 官网](im.qq.com) 下载安装最新版 QQ。

## 4. NcatBot 启动

### 准备 QQ 号

为了测试, 需要两个 QQ 号：

- **Bot**: 由 NcatBot 控制, 可以使用接口收发消息.
- **root**: 由你控制, 用于测试 Bot 的功能.

NcatBot 相当于一个电脑 QQ 客户端，因此在登陆前，==你需要退出 Bot 在其它电脑客户端上的登录。==

### 建立工作目录

建立一个==新的工作目录==(文件夹)，文件夹名为 `ncatbot`。

1. 双击进入 `ncatbot` 文件夹.

2. 文件夹新建一个 `main.py` 文件，注意[后缀名](https://zhuanlan.zhihu.com/p/112226609) 是 `.py`

3. 用记事本或者其它文本编辑器打开 `main.py` 文件，复制以下代码进去，并**保存**。

::: code-tabs
@tab Python
```python
# ========= 导入必要模块 ==========
from ncatbot.core import BotClient, PrivateMessage

# ========== 创建 BotClient ==========
bot = BotClient()

# ========= 注册回调函数 ==========
@bot.private_event()
async def on_private_message(msg: PrivateMessage):
    if msg.raw_message == "测试":
        await bot.api.post_private_msg(msg.user_id, text="NcatBot 测试成功喵~")

# ========== 启动 BotClient==========
bot.run()
```
:::

4. 右键文件夹（就像你新建那个文件一样），选择 "在终端中打开"。在跳出的窗口（即终端，通常为黑底白字）输入 `python main.py` 执行代码。

:::details 没有**在终端中打开**

部分 Windows10 操作系统确实没有这个选项。

打开你的 ncatbot 文件夹。看到窗口最上方那条地址栏了吗？（写着“此电脑 > 桌面 > ncatbot”之类）

用鼠标在这条地址栏里点一下，整条路径就会变成蓝底白字。直接按 Ctrl + C 就复制好了。

打开 PowerShell（Win+R → 输入 powershell → 回车），输入 cd "Ctrl+V 粘贴刚才复制的路径"，回车，路径就切进去了。
:::

5. 在手机上登录 Bot。电脑上按照提示输入 Bot QQ 号，然后手机扫码登录。

6. 接着使用 root 向 Bot 发送一条消息 "测试"，收到回复即正常运行。

## 5. 常见问题

### 有一步做不下去怎么办？

- 将本教程全数复制下来，发给 AI（kimi 等），并将你的疑惑告诉它，它会教你。

### 好像由红色的报错？ 

- 将出现**红色错误提示**的页面，**尽可能全的截取下来**，交给 Kimi 等 AI 助手并请求它们的帮助。
