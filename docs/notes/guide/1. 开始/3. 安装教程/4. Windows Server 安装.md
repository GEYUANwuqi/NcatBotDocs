---
title: Windows Server 安装
createTime: 2025/10/23 00:26:37
permalink: /guide/winServerinsta/
---

如果是使用云服务器进行部署，建议使用Linux环境，如果没有Linux基础，或者有特殊业务需求，那也可参考本篇关于Windows Server的安装教程。

::: warning
此教程适用 Windows Server 2019、Windows Server 2022 操作系统。
:::

> [!IMPORTANT]
> 如果你使用的是Windows Server 2019，强烈建议你先使用ie安装Microsoft Edge浏览器，而不是直接使用ie。
<br />无论使用什么版本的Windows Server，ncatbot都可能无法自行安装napcat，需要你自行安装napcat。
<br />不建议在Windows Server 2025上运行本项目，因为大多数云服务器承担不起系统的性能开销，如果硬要用，可以基本参考本篇的教程。

---
## 1. 安装 Python
进入[Python官网](https://www.python.org/)下载Python3.12的安装包。

以管理员身份运行安装包并安装Python。

如果安装包报错`0x80070659 系统策略禁止这个安装`。

那么尝试**以管理员身份运行**cmd并输入以下命令：
```shell
reg add "HKLM\Software\Policies\Microsoft\Windows\Installer" /v DisableMSI /t REG_DWORD /d 0 /f
```
或者使用 PowerShell(**管理员**) 运行以下命令：
```shell
New-Item -Path "HKLM:\Software\Policies\Microsoft\Windows" -Name "Installer" -Force | Out-Null
New-ItemProperty -Path "HKLM:\Software\Policies\Microsoft\Windows\Installer" -Name "DisableMSI" -PropertyType DWord -Value 0 -Force | Out-Null
```
然后再以管理员身份执行Python的安装。

## 2. 手动安装napcat和qq（可选）

::: note
如果在第四步中，Ncatbot自动安装napcat时出错可以参考这一步。
:::

详细可参阅[NapCat.Shell - Win 手动启动教程](https://napneko.github.io/guide/boot/Shell#napcat-shell-win-%E6%89%8B%E5%8A%A8%E5%90%AF%E5%8A%A8%E6%95%99%E7%A8%8B)。

从napcat的[Github仓库](https://github.com/NapNeko/NapCatQQ/releases)中下载最新的**NapCat.Shell.zip**。

把下载的压缩包中的文件复制到一个叫`napcat`的文件夹中，并且把文件夹移动到**ncatbot入口程序**（例如`./main.py`）的**根目录**，就像`./napcat`。

从QQ官网下载并安装最新的[QQNT](https://im.qq.com/pcqq/index.shtml)

## 3. 安装 NcatBot
::: warning
不要从 GitHub 上下载 .zip 压缩包；如果下载并解压过，请删掉解压出来的文件。
:::

项目已经发布到 PYPI, 可以使用 pip 直接下载本项目。

按下 `Win+R`, 在左下角打开**运行**, 输入 `powershell` 并回车, 打开**终端**。

复制下面的代码, 粘贴到**终端**中, 按回车执行。

::: code-tabs
@tab pip(稳定版, 推荐)

```shell
pip install ncatbot -U -i https://mirrors.aliyun.com/pypi/simple
```
:::

## 4. NcatBot 启动

### 准备 QQ 号

为了测试, 需要两个 QQ 号：

- **Bot**: 由 NcatBot 控制, 可以使用接口收发消息.
- **root**: 由你控制, 用于测试 Bot 的功能.

NcatBot 相当于一个电脑 QQ 客户端，因此在登陆前，==你需要退出 Bot 在其它电脑客户端上的登录。==

### 开始运行

建立一个==新的工作目录==(文件夹)，文件夹名为 `ncatbot`。

1. 双击进入 `ncatbot` 文件夹.

2. 在文件夹中新建一个 `main.py` 文件，注意[后缀名](https://zhuanlan.zhihu.com/p/112226609) 是 `.py`

3. 用记事本或者其它文本编辑器打开 `main.py` 文件，复制以下代码进去，并**保存**。

::: code-tabs
@tab Python
```python
# ========= 导入必要模块 ==========
from ncatbot.core import BotClient, PrivateMessage

# ========== 创建 BotClient ==========
bot = BotClient()

# ========= 注册回调函数 ==========
@bot.private_event()
async def on_private_message(msg: PrivateMessage):
    if msg.raw_message == "测试":
        await bot.api.post_private_msg(msg.user_id, text="NcatBot 测试成功喵~")

# ========== 启动 BotClient==========
bot.run()
```
:::

4. 进入 ncatbot 文件夹，点击上方的地址栏（例如`C:\Users\admin\Desktop\ncat`）,清空地址栏。然后输入 powershell → 回车，打开PowerShell窗口，接着输入 `python main.py` 运行代码。

5. 在手机上登录 Bot。电脑上按照提示输入 Bot QQ 号，然后手机扫码登录。

6. 接着使用 root 向 Bot 发送一条消息 "测试"，收到回复即正常运行。

## 5. 常见问题

### 授权操作超时

在保证napcat正常运行的前提下

考虑在启动参数中加入 enable_webui_interaction=False 跳过

即`bot.run(enable_webui_interaction=False)`

### 自动安装napcat失败

反复出现以下报错

` <urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1010)>`

`安装失败: request timed out`

尝试参考第二步[手动安装napcat](#_2-手动安装napcat和qq-可选)

### napcat无法登录qq

如果出现无法登录的问题，请先卸载掉 QQ，再去官网下载安装最新版 QQ。必要时参考第二条[手动安装napcat](#_2-手动安装napcat和qq-可选)。